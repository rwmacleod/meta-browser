From 6a626f6724a5ea58784ce42e51864da425361d9f Mon Sep 17 00:00:00 2001
From: Maksim Sisov <msisov@igalia.com>
Date: Tue, 4 May 2021 14:50:18 +0300
Subject: [PATCH] Upstream-status: Inapproriate

Upstream suggests to use Chromium's hermetic clang
instead.

Signed-off-by: Maksim Sisov <msisov@igalia.com>

---
 base/compiler_specific.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/base/compiler_specific.h b/base/compiler_specific.h
index 9fba098d95..8d730deed6 100644
--- a/base/compiler_specific.h
+++ b/base/compiler_specific.h
@@ -346,7 +346,8 @@ inline constexpr bool AnalyzerAssumeTrue(bool arg) {
 #endif  // defined(__clang_analyzer__)
 
 // Use nomerge attribute to disable optimization of merging multiple same calls.
-#if defined(__clang__) && HAS_ATTRIBUTE(nomerge)
+#if defined(__clang__) && (__clang_major__ >= 12) && \
+    HAS_ATTRIBUTE(nomerge) && !defined(OS_CHROMEOS)
 #define NOMERGE [[clang::nomerge]]
 #else
 #define NOMERGE
